---
title: 流程引擎业务场景说明
cover: false
date: 2024-01-05 16:15:47
tags:
categories:
top:
coverImg:
---
## 1. 背景介绍

### 1.1 业务背景

流程引擎作为一个底层支撑平台，它是为提供流程处理的开发而设计的。作为一个可供用户定义流程并且执行流程的业务框架。

新版流程引擎为替换旧版的流程引擎而设计实现，目标为使其符合标准化的流程设计，满足通用流程进行流程的迁移，导入需求，避免单一流程应用需要重复开发的问题，流程流转过程中配合表单设计器，结合表单一起进行使用 。

### 1.2 业务场景

|  |  |  |
| ---- | ---- | ---- |
| **场景/商业模式** | **商业价值** |  |
| 标准服务 | 流程表单，流程，应用等组件自动化生成生成流程应用。 |  |
| 定制化服务 | 提供通用微服务接口，接入各个应用实现定制化流程应用。 |  |

## 2. 产品概述

### 2.1 产品定位

流程引擎对于第三方应用进行赋能，推动系统流转和数据流转，集中流程的管控，集成和服务能力，流程数据监控。提供统一入口，流程驱动企业级应用整合。

**新版流程引擎基于BPMN 2.0流程定义**（用于定义流程的行业XML标准）， 创建这些流程定义的流程实例，进行查询，访问运行中或历史的流程实例与相关数据。

### 2.2 服务对象

微服务应用 ，办公平台，统一门户 。

### 2.3 BPMN2.0 介绍

业务流程模型和标记法（**BPMN**, Business Process Model and Notation）**是一套图形化表示法**，用于以图形的方式详细说明各种业务流程。

它最初由业务流程管理倡议组织（BPMI, Business Process Management Initiative）开发，名称为”Business Process Modeling Notation”，即“业务流程建模标记法”。BPMI 于 2005 年与对象管理组织（OMG, Object Management Group）合并。2011 年 1 月 OMG 发布 2.0 版本（时至今日，没人会用 1.0 版本了），同时改为现在的名称。

BPMN2.0 规范的实现，实质上是一个按照特定规范编写的 XML 文件，使用特定的 BPMN 设计器，即可以图形化的形式查看和编辑该文件。

{% asset_img image.png 配置图 %}

### 2.4 功能应用需求

**流程设计器**：流程设计器用于定义任务流程，用户可在该功能下进行流程的创建、设计、发布、编辑、删除、复制、查看历史版本，导入、导出管理操作。

**表单引擎：**常用控件和高级控件以及多种布局按钮设计。

**用户体系**：满足国内企业级应用需求，需要单独涉及组织机构表，然后跟流程引擎进行集成。需求多组织流程架构支持，集团总部、子公司多级组织架构，组织架构涉及到有组织、部门、用户、岗位、职务多个要素，要素间有复杂逻辑关系。

**兼容性功能需求**：抄送、会签、加签、传阅、跳转、任意流、退回、取回、撤销、一人多岗位，一人多部门无办理人时跳过，相同办理人时跳过，环节办理人范围预设，等需求扩展开发实现 。

**流程数据分析：**流程引擎可以帮助用户从多维度、多时间、多角度分析流程数据。

### 2.4 模块协作关系

{% asset_img image-1.png 配置图 %}

### 2.5 角色术语

|**角色**|**定义**|**场景一**|**场景二**|**场景三**|
|---|---|---|---|---|
|流程管理员|协助各个部门进行标准化流程定制|流程设计发布|表单设计发布|流程数据监控|
|普通用户|日常的流程使用|流程待办|流程审批|流程抄送|

## 3. 功能性需求说明

### 3.1 流程应用管理

统一入口体验，流程驱动企业级应用整合，流程通过应用的形式进行发布。


| 应用视图列表 | 已完成 | P0 | - |
| ---- | ---- | ---- | ---- |
| 应用详情 | 已完成 | P0 |  |
| 应用创建 | 已完成 | P0 |  |
| 应用编辑 | 已完成 | P0 |  |
| 应用流程绑定 | 已完成 | P0 |  |
| 应用移除 | 已完成 | P0 |  |
| 应用流程解绑 | 已完成 | P0 |  |

### 3.2 表单设计器和表单管理

用来为业务流程中的人工步骤添加表单。 有两种使用表单的方法：使用（由表单设计器创建的）表单定义的内置表单渲染，以及外部表单渲染。 使用外部表单渲染时，可以使用（自Explorer web应用V5版本支持的）表单参数；也可以使用表单key定义，引用外部的、使用自定义代码解析的表单。

此图为flowable-ui表单设计器，缺少表单布局设计，需和前端重新设计表单设计器。

{% asset_img image-2.png 配置图 %}

|表单详情查询 |已完成 | P0 | |
|---|---|---|---|
|表单设计器|进行中|P0|前端配合|
|表单发布|已完成|P0||
|表单下架|已完成|P0||
|表单编辑|已完成|P0||

### 3.3 流程定义**(process definition)**管理

构建的流程，首先需要定义一个流程一个**流程定义(process definition)**。一个_流程定义_可以启动多个**流程实例(process instance)**。_流程定义_可以看做是重复执行流程的蓝图。在未有流程设计器的情况下，可以使用第三方插件，或使用flowable-ui进行构建

此图为bpmn.js示例图

{% asset_img image-3.png 配置图 %}

| 多实例任务 - 与签 - 顺序 | 已完成 | P0 |  |
| ---- | ---- | ---- | ---- |
| 多实例任务 - 与签 - 并行 | 已完成 | P0 |  |
| 流程导入 | 待开始 | P2 |  |
| 流程定义视图列表 | 已完成 | P0 |  |
| 获取流程定义详情 | 已完成 | P0 |  |
| 发布流程 | 已完成 | P0 |  |
| 流程定义挂起 | 已完成 | P0 |  |
| 流程定义恢复 | 已完成 | P0 |  |
| 获取用户任务列表 | 已完成 | P0 | 根据流程定义，获取流程下所有用户可执行节点列表 |
| 多实例任务 - 投票 | 已完成 | P0 |  |
| 流程历史版本查询 | 待开始 | P2 |  |
| 流程版本恢复 | 待开始 | P2 |  |
| 流程设计器 | 进行中 | P0 | 前端配合 |
| 多实例任务 - 或签 | 已完成 | P0 |  |
| 流程导出 | 待开始 | P2 |  |

### 3.4 流程实例**(process instance)**管理

流程实例 代表流程定义的执行实例，比如张三请了一天假，他就必须发出一个流程实例的申请，一个流程实例包括了所有的运行节点。 我们可以用这个对象来了解当前流程实例的进度信息等。流程实例就表示一个流程从开始到结束的最大流程分支，即一个流程中流程实例只有一个。

|设置流程变量|已完成|P0 | |
|---|---|---|---|
|流程推演-预测审批路径|已完成|P0|根据流程参数推演流程路径和流程执行人名单|
|获取流程起始表单|已完成|P0||
|流程实例详情|已完成|P0||
|流程挂起|已完成|P0||
|激活流程|已完成|P0||
|销毁流程|已完成|P0||
|发起流程|已完成|P0||
|获取流程变量|已完成|P0||
|流程历史流水记录|已完成|P0|流程执行过程，不包含回退记录|
|用户流程申请表|已完成|P0||
|流程实例视图列表|已完成|P0|流程管理员操作|

### 3.5 流程任务管理

此处的任务管理，只涵盖人工任务，即需要由人手动接入控制的任务，自动化任务主要由监听任务工作完成 。

|设置任务变量|已完成|P0| |
|---|---|---|---|
|动态设置任务办理人|已完成|P0||
|获取任务表单|已完成|P0||
|获取流程当前进行任务列表|已完成|P0|多实例任务会返回多个|
|动态删除执行环节|已完成|P0||
|任务详情|已完成|P0||
|获取任务变量|已完成|P0||
|取回任务|已完成|P0|仅前置一步|
|候选任务列表|已完成|P0||
|审批任务/完成任务|已完成|P0||
|驳回任务|已完成|P0|仅回退一步|
|待办任务列表|已完成|P0||
|任务抄送已读|进行中|P1||
|任务抄送删除|进行中|P1||
|设置本地任务变量|已完成|P0|不会随着任务流转进行传递，仅保存在该任务中|
|任务抄送|已完成|P0||
|加签（向前）|已完成|P0|加签任务不能用来完成，因为这个加签的任务并不属于正常流程中的一个节点任务，加签任务完后，任务还会回到加签前的人员手里|
|转办 (向后)|已完成|P0||
|添加任务评论|已完成|P0||
|动态添加任务候选人|已完成|P0||
|任务跳转|已完成|P0|管理员使用，无视规则|
|上传任务附件|已完成|P0||
|获取当前以及下一任务节点|已完成|P0||
|查询任务评论列表|已完成|P0||
|任务抄送列表|已完成|P0||
|下载任务附件|已完成|P0||
|动态添加执行环节|已完成|P0||
|任务认领|已完成|P0|候选人方式|
|取消任务认领|已完成|P0|候选人方式|

### 3.6 流程任务人员管理

根据现有的微服务框架下人员体系，依托统一用户中心和统一认证中心数据 。进行人员设置。

|获取获选列表|进行中|P1|复合候选，需求暂不明确。|
|---|---|---|---|
|获取岗位下管辖用户|已完成|P0||
|获取用户列表|已完成|P0||
|获取部门下成员|已完成|P0||
|获取单位下成员|已完成|P0||
|获取岗位下成员|已完成|P0||
|获取角色下成员|待开始|P1||
|获取当前登录用户|已完成|P0||

### 3.7 流程消息通知 （未开始）

由于微服务消息中心尚未实现，等消息中心完成之后对其进行接入实现消息通知功能。近期内会对消息中心进行规划，消息配置和流程通知模板统一构建在消息中心内，流程只作系统对接服务。

### 3.8 流程任务监听器

用于在特定的任务相关事件发生时，执行自定义的代码逻辑 ，多数的兼容性功能都由该功能实现。

|超时自动完成监听|待开始|P2|
|---|---|---|---|
|超时催办监听|待开始|P2||
|超时自动驳回监听|待开始|P2||
|任务无执行人自动跳过监听|已完成|P2||
|业务系统回调消息队列监听|待开始|P2||
|多实例任务用户设置监听|已完成|P0||
|单实例任务用户设置监听|已完成|P0||
|业务系统回调监听|已完成|P0||
|相同执行人自动跳过监听|已完成|P2||

### 3.9 流程图绘制

| 流程描红功能 | 已完成 | P0 |  |
| ---- | ---- | ---- | ---- |
| 获取流程定义图 | 已完成 | P1 |  |
| 根据任务获取流程图 | 已完成 | P2 |  |
| 根据流程获取流程执行图 | 已完成 | P0 |  |
| 流程回退清除历史记录 | 已完成 | P0 |  |

### 3.10 流程数据统计 （未开始）

预计通过数据采集模块统一汇总到数据中台进行数据分析，汇总和展示。

## 4. 非功能需求

相关指标暂未界定，后续协商再行补充 。

性能需求

安全需求

可靠性需求

可维护性需求

可用性需求

兼容性需求

运营需求

## 5. 未来的规划和目标

#### 5.1 中台化

对于信息化软件的演进，从流程线和开发部署方式两条线来看，分别从轻到重和从重到轻发展，交汇于数字中台。从部署 开发一线来看，传统的开发部署模式时间长、成本高、系统割裂，不能满足企业实现“成本效益”的需求，因而数字中台 转型成为必然的选择。

#### 5.2 低代码

需求端的 复杂多变对软件开发提出了新的要求，市场要求软件的开发的速度越快越好、交付时间越来越短，“低代码”应运而生。 BPM 在未来也将充分与低代码相结合，BPM 的低代码化主要包含设计端的应用。开发人员寻找通用的开发活动，然后为 所有环节构建一个基本代码并将它们封装在某个可视化的模块里。基于这些模块，业务人员就可以通过拖拉拽的方式，在 可视化的设计器上像“搭积木”一样，对表单、流程和应用进行搭建。

#### 5.3 智能化

业务流程管理（BPM）已成为企业内部优化的选择。流程的优化通过节省时间并降低成本为公司带来竞争优势，使员工更 有效地工作。随着市场的成熟度日益提高，各种新兴技术不断发展，BPM 自身也需要与时代结合，不断发展。未来 BPM 将进一步与AI（人工智能）等智能化技术相结合，为企业提供更敏捷、优质的服务。